/*!
 * Webtags v0.4.3-pl, Dashboard for Webtags v1.0.14-pl
 * Webtags GitHub page (source code and links): (https://github.com/earthperson/Webtags)
 * Webtags website: (http://earthperson.github.io/Webtags/)
 * Dashboard for Webtags: (http://earthperson.github.io/Webtags/dashboard/)
 * Author website: (http://earthperson.info)
 *
 * Copyright (c) 2013-2014 Dmitry Ponomarev (email: ponomarev.dev@gmail.com)
 * Licensed under the MIT License: (http://www.opensource.org/licenses/mit-license.php)
 */
function Webtags(a){if(a instanceof Object&&a.items){for(var b in a)this.properties[b]=a[b];this.canvas.render()}}Webtags.prototype.properties={},Webtags.prototype.canvas=null,function(a){function b(){var a,b={id:"webtags",type:"rounded",width:500,height:350,border:!0,grid:!1,style:{border:"1px solid #5e8cc2"}};for(a in b)this.properties[a]=b[a]}function c(){}function d(a,b){this.context=a,this.item=b,c.prototype.render.call(this),this.render(),c.prototype.line.width+=Math.floor(this.edgeWidth()+this.text.width),c.prototype.count++}function e(a,b){this.context=a,this.item=b,c.prototype.render.call(this),this.render(),c.prototype.line.width+=Math.floor(41+this.text.width),c.prototype.count++}b.prototype=new a,b.prototype.items=[],b.prototype.hover=null,b.POWERED_BY={LABEL:"Powered by Webtags v0.4.3-pl",URL:"https://github.com/earthperson/Webtags",FONT:"10px Helvetica"},b.prototype.poweredBy={x:null,y:null},b.prototype.element=null,b.prototype.getMousePosition=function(a,b){var c=a.getBoundingClientRect();return{x:b.clientX-c.left,y:b.clientY-c.top}},b.prototype.onMousemove=function(a){var c,d,e=b.prototype.getMousePosition(b.prototype.element,a),f=e.x,g=e.y;document.body.style.cursor=b.prototype.hover=null;for(c in b.prototype.items)if(d=b.prototype.items[c].text,f>=parseInt(d.x+d.translating.x)&&f<=parseInt(d.x+d.translating.x)+parseInt(d.width)&&g>=parseInt(d.y+d.translating.y)&&g<=parseInt(d.y+d.translating.y)+parseInt(d.height)){document.body.style.cursor="pointer",b.prototype.hover=b.prototype.items[c].item.url;break}b.prototype.properties.border&&(d=b.prototype.poweredBy,f>=d.x&&f<=b.prototype.properties.width&&g>=d.y-1&&g<=b.prototype.properties.height&&(document.body.style.cursor="pointer",b.prototype.hover=b.POWERED_BY.URL))},b.prototype.onClick=function(){b.prototype.hover&&window.open(b.prototype.hover)},b.prototype.render=function(){var a=b.prototype.element=document.getElementById(this.properties.id);if(a.width=this.properties.width,a.height=this.properties.height,a.style.border=this.properties.border?this.properties.style.border:"none",a.getContext){var f=a.getContext("2d"),g=0,h=this.properties.items.length;for(f.clearRect(0,0,a.width,a.height),c.prototype.count=0,c.prototype.line={width:0,count:0},a.addEventListener("mousemove",b.prototype.onMousemove,!1),a.addEventListener("click",b.prototype.onClick,!1);h>g;g++)b.prototype.items.push(new("square"==this.properties.type?e:d)(f,this.properties.items[g]));f.fillStyle=this.properties.style.border.match(/#\w{3,}$/)||"#5e8cc2",this.properties.border&&(f.font=b.POWERED_BY.FONT,this.poweredBy.x=parseInt(b.prototype.properties.width-f.measureText(b.POWERED_BY.LABEL).width),this.poweredBy.y=parseInt(b.prototype.properties.height-parseInt(b.POWERED_BY.FONT)),f.fillText(b.POWERED_BY.LABEL,this.poweredBy.x,this.poweredBy.y-1))}},b.prototype.toString=function(){this.render()},c.prototype.properties={width:100,height:32,context:{fillStyle:"#5e8cc2",textBaseline:"top",font:"12px Arial",strokeStyle:"#5e8cc2",lineWidth:2,lineJoin:"round",lineCap:"round",shadowOffsetX:2,shadowOffsetY:2,shadowBlur:2,shadowColor:"rgba(54, 111, 179, 0.4)"}},c.prototype.context=null,c.prototype.item=null,c.prototype.text=null,c.prototype.getRandomFactor=function(){return 10*Math.random()+1},c.prototype.offsetX=function(){var a=c.prototype.properties.width+this.edgeWidth();return parseFloat(this.count%Math.floor(b.prototype.properties.width/a)*a)},c.prototype.offsetY=function(){var a=c.prototype.properties.width+this.edgeWidth();return Math.floor(this.count/Math.floor(b.prototype.properties.width/a))*(c.prototype.properties.height+8)},c.prototype.translateX=function(){return this.line.width+this.text.width>b.prototype.properties.width-this.edgeWidth()?(this.line.width=0,this.line.count++,0):this.line.width},c.prototype.edgeWidth=function(){return"rounded"==b.prototype.properties.type?16+c.prototype.properties.height+2:41},c.prototype.translateY=function(){return(c.prototype.properties.height+8)*c.prototype.line.count},c.prototype.render=function(){var a,d,e=this.getRandomFactor(),f=b.prototype.properties;if(f.tag instanceof Object)for(d in f.tag)if("context"===d&&f.tag.context instanceof Object)for(d in f.tag.context)this.properties.context[d]=f.tag.context[d];else this.properties[d]=f.tag[d];for(d in this.properties.context)this.context[d]=this.properties.context[d];a=Math.floor(c.prototype.properties.height/2),this.text={x:34,y:a,translating:{x:0,y:0}},this.text.width=this.context.measureText(this.item.label).width,this.text.height=parseInt(this.context.font),this.context.save(),b.prototype.properties.grid?(this.text.translating.x=this.offsetX(),this.text.translating.y=this.offsetY()):(this.text.translating.x=this.translateX(),this.text.translating.y=this.translateY()),this.context.translate(this.text.translating.x,this.text.translating.y),this.context.beginPath(),this.context.arc(26,4+a,4,0,2*Math.PI),this.context.moveTo(4,18),this.context.bezierCurveTo(2+e,10+e,8,10,10,14),this.context.bezierCurveTo(13,23,16,17,27,4+a),this.context.moveTo(2,26),e=this.getRandomFactor(),this.context.quadraticCurveTo(2+e,18+e,12,22),this.context.quadraticCurveTo(18,28,27,4+a),this.context.stroke(),this.context.fillText(this.item.label,this.text.x,this.text.y-2),this.context.restore()},d.prototype=new c,d.prototype.render=function(){var a=Math.floor(c.prototype.properties.height/2);this.context.save(),b.prototype.properties.grid?this.context.translate(this.offsetX(),this.offsetY()):this.context.translate(this.translateX(),this.translateY()),this.context.beginPath(),this.context.arc(16+a,4+a,a,.5*Math.PI,1.5*Math.PI),b.prototype.properties.grid?(this.context.lineTo(16+a+c.prototype.properties.width,4),this.context.arc(16+a+c.prototype.properties.width,4+a,a,1.5*Math.PI,.5*Math.PI)):(this.context.lineTo(16+a+this.text.width,4),this.context.arc(16+a+this.text.width,4+a,a,1.5*Math.PI,.5*Math.PI)),this.context.closePath(),this.context.stroke(),this.context.restore()},e.prototype=new c,e.prototype.render=function(){this.context.save(),b.prototype.properties.grid?this.context.translate(this.offsetX(),this.offsetY()):this.context.translate(this.translateX(),this.translateY()),this.context.beginPath(),this.context.moveTo(16,4+Math.floor(c.prototype.properties.height/2)),this.context.lineTo(23,4),b.prototype.properties.grid?(this.context.lineTo(23+c.prototype.properties.width,4),this.context.lineTo(23+c.prototype.properties.width,c.prototype.properties.height+4)):(this.context.lineTo(39+this.text.width,4),this.context.lineTo(39+this.text.width,c.prototype.properties.height+4)),this.context.lineTo(23,c.prototype.properties.height+4),this.context.closePath(),this.context.stroke(),this.context.restore()},a.prototype.canvas=new b}(Webtags);