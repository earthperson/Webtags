/*
 * Webtags v0.1.1-alpha1, Dashboard for webtags v1.0.2-alpha1 (https://github.com/earthperson/webtags)
 * 
 * Copyright (c) 2013 Dmitry Ponomarev (email: ponomarev.dev@gmail.com) 
 * Licensed under the MIT License: http://www.opensource.org/licenses/mit-license.php
 */
function Webtags(c){if(c instanceof Object&&c.items){for(var b in c){Webtags.prototype.properties[b]=c[b]}this.canvas.render()}}Webtags.prototype.properties={};Webtags.prototype.canvas=null;(function(b){function a(){this.properties.width=500;this.properties.height=350;this.properties.style={border:"1px solid #5e8cc2"}}a.prototype=new b();a.prototype.items=[];a.prototype.hover=null;a.prototype.text={label:"Powered by Webtags",url:"https://github.com/earthperson/Webtags",width:null,height:null,x:398,y:338,context:{font:"10px Helvetica"}};a.prototype.onMousemove=function(h){var f,j,g,i;if(h.layerX||h.layerX==0){f=h.layerX;j=h.layerY}f-=canvas.offsetLeft;j-=canvas.offsetTop;for(g in a.prototype.items){i=a.prototype.items[g].text;if(f>=parseInt(i.x)&&f<=(parseInt(i.x)+parseInt(i.width))&&j>=parseInt(i.y)&&j<=(parseInt(i.y)+parseInt(i.height))){document.body.style.cursor="pointer";a.prototype.hover=a.prototype.items[g].item.url;break}else{document.body.style.cursor=a.prototype.hover=null}}i=a.prototype.text;if(f>=parseInt(i.x)&&f<=(parseInt(i.x)+parseInt(i.width))&&j>=parseInt(i.y)&&j<=(parseInt(i.y)+parseInt(i.height))){document.body.style.cursor="pointer";a.prototype.hover=a.prototype.text.url}else{document.body.style.cursor=a.prototype.hover=null}};a.prototype.onClick=function(f){if(a.prototype.hover){window.open(a.prototype.hover)}};a.prototype.render=function(){var h=document.getElementById("canvas");h.width=this.properties.width;h.height=this.properties.height;h.style.border=this.properties.border?this.properties.style.border:"none";if(h.getContext){var k=h.getContext("2d"),j=0,g=this.properties.items.length;k.clearRect(0,0,h.width,h.height);h.addEventListener("mousemove",a.prototype.onMousemove,false);h.addEventListener("click",a.prototype.onClick,false);d.prototype.count=0;for(;j<g;j++){a.prototype.items.push(new (this.properties.type=="rounded"?e:c)(k,this.properties.items[j]))}if(this.properties.border){for(var f in this.text.context){k[f]=this.text.context[f]}k.fillText(this.text.label,this.text.x,this.text.y);this.text.width=k.measureText(this.text.label).width;this.text.height=parseInt(this.text.context.font)}}else{}};a.prototype.toString=function(){this.render()};function d(){}d.prototype.properties={width:100,height:40,context:{fillStyle:"#5e8cc2",textBaseline:"top",font:"12px Arial",strokeStyle:"#5e8cc2",lineWidth:2,lineJoin:"round",lineCap:"round",shadowOffsetX:2,shadowOffsetY:2,shadowBlur:2,shadowColor:"rgba(54, 111, 179, 0.4)"}};d.prototype.context=null;d.prototype.item=null;d.prototype.text=null;d.prototype.getRandomFactor=function(){return(Math.random()*10)+1};d.prototype.count=0;d.prototype.getMx=function(){return parseFloat((this.count%(a.prototype.properties.width/d.prototype.properties.width))*d.prototype.properties.width)};d.prototype.getMy=function(){return Math.floor(this.count/(a.prototype.properties.width/d.prototype.properties.width))*d.prototype.properties.height};d.prototype.render=function(){var g=this.getRandomFactor(),i=this.getMx(),h=this.getMy(),f;for(f in this.properties.context){this.context[f]=this.properties.context[f]}this.context.beginPath();this.context.arc(26+i,20+h,4,0,Math.PI*2);this.context.moveTo(4+i,18+h);this.context.bezierCurveTo(2+g+i,10+g+h,8+i,10+h,10+i,14+h);this.context.bezierCurveTo(13+i,23+h,16+i,17+h,27+i,20+h);this.context.moveTo(2+i,26+h);g=this.getRandomFactor();this.context.quadraticCurveTo(2+g+i,18+g+h,12+i,22+h);this.context.quadraticCurveTo(18+i,28+h,27+i,20+h);this.context.stroke();this.text={x:34+i,y:15+h};this.context.fillText(this.item.label,this.text.x,this.text.y);this.text.width=this.context.measureText(this.item.label).width;this.text.height=parseInt(this.context.font)};function e(f,g){this.context=f;this.item=g;d.prototype.render.call(this);this.render();d.prototype.count++}e.prototype=new d();e.prototype.render=function(){var g=this.getMx(),f=this.getMy();this.context.beginPath();this.context.arc(32+g,20+f,16,0.5*Math.PI,1.5*Math.PI);this.context.lineTo(80+g,4+f);this.context.arc(80+g,20+f,16,1.5*Math.PI,0.5*Math.PI);this.context.closePath();this.context.stroke()};function c(f,g){this.context=f;this.item=g;d.prototype.render.call(this);this.render();d.prototype.count++}c.prototype=new d();c.prototype.render=function(){var g=this.getMx(),f=this.getMy();this.context.beginPath();this.context.moveTo(16+g,20+f);this.context.lineTo(23+g,4+f);this.context.lineTo(96+g,4+f);this.context.lineTo(96+g,36+f);this.context.lineTo(23+g,36+f);this.context.closePath();this.context.stroke()};b.prototype.canvas=new a()})(Webtags);