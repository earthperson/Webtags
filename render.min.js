/*!
 * Webtags v0.4.6-pl, Dashboard for Webtags v1.0.17-pl
 * Webtags GitHub page (source code and links): (https://github.com/earthperson/Webtags)
 * Webtags website: (http://earthperson.github.io/Webtags/)
 * Dashboard for Webtags: (http://earthperson.github.io/Webtags/dashboard/)
 * Author website: (http://earthperson.info)
 *
 * Copyright (c) 2013-2014 Dmitry Ponomarev (email: ponomarev.dev@gmail.com)
 * Licensed under the MIT License: (http://www.opensource.org/licenses/mit-license.php)
 */
!function(a){function b(a){if(a instanceof Object&&a.items){b.prototype.options=a;var d=new c;d.render&&d.render.call(d)}}function c(){this.settings={items:[],id:"webtags",type:"rounded",width:500,height:350,border:!0,grid:!1,style:{border:"1px solid #5e8cc2"},tag:{},_poweredBy:{x:null,y:null},_url:null};var a=g(this.settings,b.prototype.options);for(var c in a)this[c]=a[c];this._element=document.getElementById(this.id)}function d(){}function e(a,b,c){this.context=a,this.item=b,this.canvas=c,d.prototype.render.call(this),this.render(),d.prototype.line.width+=Math.floor(this.edgeWidth()+this.text.width),d.prototype.count++}function f(a,b,c){this.context=a,this.item=b,this.canvas=c,d.prototype.render.call(this),this.render(),d.prototype.line.width+=Math.floor(41+this.text.width),d.prototype.count++}function g(a,b){for(var c in b)try{a[c]=b[c].constructor==Object?g(a[c],b[c]):b[c]}catch(d){a[c]=b[c]}return a}c.POWERED_BY={LABEL:"Powered by Webtags v0.4.6-pl",URL:"https://github.com/earthperson/Webtags",FONT:"10px Helvetica"},c.prototype.getMousePosition=function(a,b){var c=a.getBoundingClientRect();return{x:b.clientX-c.left,y:b.clientY-c.top}},c.prototype.onMousemove=function(a){var b,d,e=c.prototype.getMousePosition(this,a),f=e.x,g=e.y;document.body.style.cursor=this._url=null;for(b in this.items)if(d=this.items[b].text,d&&f>=parseInt(d.x+d.translating.x)&&f<=parseInt(d.x+d.translating.x)+parseInt(d.width)&&g>=parseInt(d.y+d.translating.y)&&g<=parseInt(d.y+d.translating.y)+parseInt(d.height)){document.body.style.cursor="pointer",this._url=this.items[b].item.url;break}this.border&&(d=this._poweredBy,f>=d.x&&f<=this.width&&g>=d.y-1&&g<=this.height&&(document.body.style.cursor="pointer",this._url=c.POWERED_BY.URL))},c.prototype.onClick=function(){this._url&&a.open(this._url)},c.prototype.render=function(){if(this._element.width=this.width,this._element.height=this.height,this._element.style.border=this.border?this.style.border:"none",this._element.getContext){var a=this._element.getContext("2d"),b=0,g=this.items.length;for(a.clearRect(0,0,this.width,this.height),d.prototype.count=0,d.prototype.line={width:0,count:0},this._element.addEventListener("mousemove",c.prototype.onMousemove,!1),this._element.items=this.items,this._element.addEventListener("click",c.prototype.onClick,!1);g>b;b++)this.items.push(new("square"==this.type?f:e)(a,this.items[b],this));a.fillStyle=this.style.border.match(/#\w{3,}$/)||"#5e8cc2",this.border&&(a.font=c.POWERED_BY.FONT,this._poweredBy.x=parseInt(this.width-a.measureText(c.POWERED_BY.LABEL).width),this._poweredBy.y=parseInt(this.height-parseInt(c.POWERED_BY.FONT)),a.fillText(c.POWERED_BY.LABEL,this._poweredBy.x,this._poweredBy.y-1))}},c.prototype.toString=function(){return"[object Canvas]"},d.prototype.properties={width:100,height:32,context:{fillStyle:"#5e8cc2",textBaseline:"top",font:"12px Arial",strokeStyle:"#5e8cc2",lineWidth:2,lineJoin:"round",lineCap:"round",shadowOffsetX:2,shadowOffsetY:2,shadowBlur:2,shadowColor:"rgba(54, 111, 179, 0.4)"}},d.prototype.context=null,d.prototype.item=null,d.prototype.text=null,d.prototype.getRandomFactor=function(){return 10*Math.random()+1},d.prototype.offsetX=function(){var a=d.prototype.properties.width+this.edgeWidth();return parseFloat(this.count%Math.floor(this.canvas.width/a)*a)},d.prototype.offsetY=function(){var a=d.prototype.properties.width+this.edgeWidth();return Math.floor(this.count/Math.floor(this.canvas.width/a))*(d.prototype.properties.height+8)},d.prototype.translateX=function(){return this.line.width+this.text.width>this.canvas.width-this.edgeWidth()?(this.line.width=0,this.line.count++,0):this.line.width},d.prototype.edgeWidth=function(){return"rounded"==this.canvas.type?16+d.prototype.properties.height+2:41},d.prototype.translateY=function(){return(d.prototype.properties.height+8)*d.prototype.line.count},d.prototype.render=function(){var a,b,c=this.getRandomFactor();g(this.properties,this.canvas.tag);for(b in this.properties.context)this.context[b]=this.properties.context[b];a=Math.floor(d.prototype.properties.height/2),this.text={x:34,y:a,translating:{x:0,y:0}},this.text.width=this.context.measureText(this.item.label).width,this.text.height=parseInt(this.context.font),this.context.save(),this.canvas.grid?(this.text.translating.x=this.offsetX(),this.text.translating.y=this.offsetY()):(this.text.translating.x=this.translateX(),this.text.translating.y=this.translateY()),this.context.translate(this.text.translating.x,this.text.translating.y),this.context.beginPath(),this.context.arc(26,4+a,4,0,2*Math.PI),this.context.moveTo(4,18),this.context.bezierCurveTo(2+c,10+c,8,10,10,14),this.context.bezierCurveTo(13,23,16,17,27,4+a),this.context.moveTo(2,26),c=this.getRandomFactor(),this.context.quadraticCurveTo(2+c,18+c,12,22),this.context.quadraticCurveTo(18,28,27,4+a),this.context.stroke(),this.context.fillText(this.item.label,this.text.x,this.text.y-2),this.context.restore()},e.prototype=new d,e.prototype.render=function(){var a=Math.floor(d.prototype.properties.height/2);this.context.save(),this.canvas.grid?this.context.translate(this.offsetX(),this.offsetY()):this.context.translate(this.translateX(),this.translateY()),this.context.beginPath(),this.context.arc(16+a,4+a,a,.5*Math.PI,1.5*Math.PI),this.canvas.grid?(this.context.lineTo(16+a+d.prototype.properties.width,4),this.context.arc(16+a+d.prototype.properties.width,4+a,a,1.5*Math.PI,.5*Math.PI)):(this.context.lineTo(16+a+this.text.width,4),this.context.arc(16+a+this.text.width,4+a,a,1.5*Math.PI,.5*Math.PI)),this.context.closePath(),this.context.stroke(),this.context.restore()},f.prototype=new d,f.prototype.render=function(){this.context.save(),this.canvas.grid?this.context.translate(this.offsetX(),this.offsetY()):this.context.translate(this.translateX(),this.translateY()),this.context.beginPath(),this.context.moveTo(16,4+Math.floor(d.prototype.properties.height/2)),this.context.lineTo(23,4),this.canvas.grid?(this.context.lineTo(23+d.prototype.properties.width,4),this.context.lineTo(23+d.prototype.properties.width,d.prototype.properties.height+4)):(this.context.lineTo(39+this.text.width,4),this.context.lineTo(39+this.text.width,d.prototype.properties.height+4)),this.context.lineTo(23,d.prototype.properties.height+4),this.context.closePath(),this.context.stroke(),this.context.restore()},a.Webtags=b}(window);